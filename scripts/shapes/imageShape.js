const DEFAULTIMAGE = "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";

class ImageShape extends BaseShape {
    constructor(board, parent, id) {
        super(board, parent, id);
        this.hasForm = true;
    }

    createTransformer() { 
        return new RectangleTransformer(this.board, this);
    }

    createForm() {
        return $("<div id='shape-form'></div>").dxForm({
            colCount: 1,
            onFieldDataChanged: e => this.setProperty(e.dataField, e.value),
            items: [
                  {
                    dataField: "name",
                    label: { text: "Name", visible: false },
                    editorType: "dxTextBox",
                    editorOptions: {
                        stylingMode: "filled"
                    }
                  },
                  {
                    dataField: "file",
                    label: { text: "File" },
                    editorType: "dxFileUploader",
                    editorOptions: {
                        accept: "image/*",
                        onFilesUploaded: e => {
                            const file = e.component.option("value")[0];
                            const reader = new FileReader();
                            reader.onload = e => {
                                this.properties.imageBase64 = e.target.result.split(',')[1];
                                this.element.setAttribute("href", "data:image/png;base64," + this.properties.imageBase64);
                            };
                            reader.readAsDataURL(file);
                        }
                    }
                  },
                  {
                    dataField: "xTerm",
                    label: { text: "X Variable" },
                    editorType: "dxTextBox",
                    editorOptions: {
                        stylingMode: "filled"
                    }
                  },
                  {
                    dataField: "yTerm",
                    label: { text: "Y Variable" },
                    editorType: "dxTextBox",
                    editorOptions: {
                        stylingMode: "filled"
                    }
                  }
                ]
            });
    }

    setDefaults() {
        var center = this.board.getClientCenter();
        this.properties.x = center.x - 50;
        this.properties.y = center.y - 50;
        this.properties.width = 100;
        this.properties.height = 100;
        this.properties.rotation = 0;
    }

    createElement() {
        const image = this.board.createSvgElement("image");
        image.setAttribute("href", "data:image/png;base64," + (this.properties.imageBase64 ?? DEFAULTIMAGE));
        image.setAttribute("preserveAspectRatio", "xMidYMid slice");
        return image;
    }    

    update() {
        this.properties.x = this.properties.xTerm != "" ? this.board.calculator.getByName(this.properties.xTerm) : this.properties.x;
        this.properties.y = this.properties.yTerm != "" ? this.board.calculator.getByName(this.properties.yTerm) : this.properties.y; 
    }

    draw() {
        this.element.setAttribute("x", this.properties.x);
        this.element.setAttribute("y", this.properties.y);
        this.element.setAttribute("width", this.properties.width);
        this.element.setAttribute("height", this.properties.height);
        this.element.setAttribute("transform", `rotate(${this.properties.rotation}, ${this.properties.x + this.properties.width / 2}, 
            ${this.properties.y + this.properties.height / 2})`);
    }
}